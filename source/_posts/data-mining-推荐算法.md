---
title: data-mining-推荐算法
mathjax: true
tags:
  - 推荐算法
categories:
  - 数据挖掘
  - 推荐算法
abbrlink: 4225
date: 2021-11-24 22:02:47
---

# TF-IDF

### tf

首先思考一个问题，搜索一个关键词的时候，我们一般很快想到这个词在这个文本中出现的次数，如果次数多的话那么我们可以认为这个文本对于这个关键字来说是匹配的

故提出了TF概念，其实本质上来说就是单词在文本中出现的频率

<!--more-->
$$
tf(t,d) = \frac{n_{t,d}}{\sum_{k}n_{k,d}}
$$

### idf

再思考这么一个问题，仅仅考虑频率合理吗？例如一个文本中含有大量“我，的”这种词，而你的搜索词中正好也有这两个词的话，那么现在我们通常情况下都不会考虑这个频繁词，那么我们如何来实现这一件事情呢？于是人们提出了IDF的概念，用来抵消这一现象
$$
idf(t,D) = log\frac{|D|}{| \{ d \in D:t\in d \}|}
$$
其中分子$|D|$指的是文档的个数，分母指的是包含关键字的文档的个数。举个例子来说，有两个文本，其中两个文本都有"的"，那么分子就是2，分母也是2，结果是1再取对数就是0。

### tf-idf

接下来就很简单了，该描述我们的TF-IDF了，所谓TF-IDF就是将TF和IDF进行一个相乘的运算，即
$$
tf-idf = tf × idf
$$
很明显从这个公式中我们可以知道，IDF它什么样的情况下会大呢，它希望这个关键词在我的文本出现的多并且在别的文档中出现的次数少，这样才会显得我的文本比别人的显得有特点。

### multiple query word

那么当出现了有多个查询呢，例如computer network，那么就对两个单词做拆分，分别计算每个单词的tf-idf，然后最后进行一个累加操作，非常简单
$$
score = \sum_{t\in q}tf-idf(t,d,D)
$$
### 需要思考的问题

​	现在可以计算tf-idf了，接下来我们需要干什么呢？答案是将文本输入到计算机中去！但是计算机是理解不了我们的文本的呀，所以说有一个聪明的人他简单粗暴的将文本中含有多少个词，就对应与一个向量vector，例如这个文本中有10000个单词的话，那就直接将这个单词映射为10000维的向量，对其中的每一个单词上进行编码的话就是让对应的向量某一位为1，其它位为0，这样就可以表示这1万个向量，但是这种表示方法（词袋模型）很快就会出现许多问题，例如：

+ 如果单词数量非常多的话，那么这个维数就会非常高，在计算过程当中，就会平增许多复杂的计算
+ 这种方法没有考虑单词与单词之间的关系，其实单词与单词之间是有关系，ont-hot编码方式直接认为各个单词之间是不相关的

还有一种表示方法，就是将一篇文档映射成一个向量，我认为这个是借鉴了one-hot的思想，它将一篇文档假设有1000个关键词，如果当这个关键词存在的话，则在对应的位置上改变数字，这个数字可以是1，也可以是出现的次数，也可以是对应关键字的tf-idf值，这些都是可行的，可表示为 $p=(w_{1,p},w_{2,p},...,w_{t,p})$

当可以将文档表示为vector的话，那么就可以计算两篇文章的相似度了，在这里我们使用余弦相似度来计算，余弦相似度和欧式距离在本质上是没有区别的，因为在计算方式（公式上）上可以等同为两个比较是等价的：
$$
sim(p,q) = cos(\theta)=\frac{p\cdot q}{|p|\cdot|q|}
$$
​	这样可以对文档进行聚类，但是实际来说是非常困难的，为什么呢？因为会出现许多的同义词，例如poor recall和poor precision这两个问题，poor recall指的是例如对应于我想搜索一个car但是有很多vehicle的文章并没有给我显示出来，poor precision例如搜索一个apple，对应水果和apple公司，你如何去做抉择，给你的搜索用户返回对应的页面呢？是各自50篇？都具有各自的问题，对于这一种现象的处理，后面有学者研究出了矩阵分解的相关方法来处理。

## Latent Semantic Analysis  隐含语义分析

首先直接给出公式
$$
X = TSD^T
$$
其中的X就是term-document矩阵，然后对X进行分解，咋一看非常像奇异值分解，关于奇异值分解我后续也会出一篇文章讲解一下（先画饼），其中T是一个正交阵，D也是一个正交阵，S是一个对角阵（类似于特征值矩阵），X：m×n ；T：m×r；S：r×r；D：n×r；其中r=rank(X)

那么现在我们来计算$XX^T$将会等于一个什么值，其中会有很巧妙的tips
$$
XX^T = (TSD^T)(TSD^T)^T = (TSD^TDS^TT^T)=T(SS^T)T^T
	= (TS)(TS)^T
$$
很奇怪我们为什么想要计算$XX^T$这一个东东呢？其实我们可以通过矩阵计算来解释一下，对于$XX^T$矩阵的第ij元素来说就是，第i个关键字与第j个关键字做了一个內积的和，这种的话我们从上面这个变换过程中可以看出，我们可以使用TS这一个矩阵替代掉原来的X矩阵，相当是使用了一个新的向量空间中的向量来替代对应的X矩阵，这个是对于term来说的，那如果我想对document也做一个类似这样的变化怎么搞？其实细心的人就会发现，只要将$XX^T$反过来即可也就是计算$X^TX$就能实现，现在还有一个问题，TS这个矩阵的维度和原来应该是一样的吗？

